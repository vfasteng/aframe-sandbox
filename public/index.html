<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>A-Frame React Boilerplate</title>
    <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
    <script src="https://rawgit.com/google-ar/three.ar.js/master/dist/three.ar.js"></script>
    <script src="https://rawgit.com/chenzlabs/aframe-three-ar/master/dist/aframe-ar.js"></script>
    <script>
    AFRAME.registerComponent("samsung-logo", {
  init: function() {
    var el = this.el;
    var purple = new THREE.MeshBasicMaterial();
    purple.color = new THREE.Color("#706CF5");
    var white = new THREE.MeshBasicMaterial();
    white.color = new THREE.Color("#ffffff");
    // el.addEventListener("model-loaded", function() {
    //   el.object3D.traverse(function(o) {
    //     if (o.material) {
    //       o.material = o.material.name === "Purple" ? purple : white;
    //     }
    //   });
    // });
  }
});

const content = `
      <a-entity obj-model="obj: #dyno-obj;mtl: #dyno-mtl" samsung-logo>
        <a-animation from="0 -360 45" to="0 0 0" easing="ease-out-back" begin="model-loaded" dur="3000"></a-animation>
        <a-animation from="0 0 0" to="1 1 1" easing="ease-out-back" begin="model-loaded" dur="2000" attribute="scale"></a-animation>
        <a-animation from="0 -1 0" to="0 0 0" easing="ease-out-back" begin="model-loaded" dur="1000" attribute="position"></a-animation>
      </a-entity>`;

window.addEventListener("click", function() {
  // Put the logo where the mark is.
  var mark = document.querySelector("#mark");
  var el = document.createElement("a-entity");
  AFRAME.scenes[0].appendChild(el);
  el.innerHTML = content;
  el.setAttribute("scale", "0.1, 0.1, 0.1");
  el.setAttribute("position", mark.getAttribute("position"));
});
</script>
  </head>
  <body>
    <div id="sceneContainer" style="height: 100%; width: 100%"></div>
    <script>
window.onload = () => {
  var raycaster = document.querySelector("[ar-raycaster]");
  var mark = document.querySelector("#mark");

  raycaster.addEventListener("raycaster-intersection", function(evt) {
    // Turn the mark green and move it to the intersection point.
    mark.setAttribute("color", "green");
    // FIXME: lerp position
    mark.setAttribute("position", evt.detail.intersections[0].point);
  });

  raycaster.addEventListener("raycaster-intersection-cleared", function(evt) {
    // Turn the mark red.  FIXME: lerp position
    mark.setAttribute("color", "red");
  });
};
</script>
  </body>
</html>
